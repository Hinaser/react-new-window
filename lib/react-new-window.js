"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var React=_interopDefault(require("react")),ReactDOM=_interopDefault(require("react-dom"));function unwrapExports(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var classCallCheck=createCommonjsModule(function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports}),_classCallCheck=unwrapExports(classCallCheck),_typeof_1=createCommonjsModule(function(e){function t(o){"@babel/helpers - typeof";return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(o)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports});unwrapExports(_typeof_1);var toPrimitive_1=createCommonjsModule(function(e){var t=_typeof_1.default;e.exports=function(e,o){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,o||"default");if("object"!=t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===o?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports});unwrapExports(toPrimitive_1);var toPropertyKey_1=createCommonjsModule(function(e){var t=_typeof_1.default;e.exports=function(e){var o=toPrimitive_1(e,"string");return"symbol"==t(o)?o:o+""},e.exports.__esModule=!0,e.exports.default=e.exports});unwrapExports(toPropertyKey_1);var createClass=createCommonjsModule(function(e){function t(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,toPropertyKey_1(r.key),r)}}e.exports=function(e,o,r){return o&&t(e.prototype,o),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports}),_createClass=unwrapExports(createClass),assertThisInitialized=createCommonjsModule(function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports});unwrapExports(assertThisInitialized);var possibleConstructorReturn=createCommonjsModule(function(e){var t=_typeof_1.default;e.exports=function(e,o){if(o&&("object"==t(o)||"function"==typeof o))return o;if(void 0!==o)throw new TypeError("Derived constructors may only return object or undefined");return assertThisInitialized(e)},e.exports.__esModule=!0,e.exports.default=e.exports}),_possibleConstructorReturn=unwrapExports(possibleConstructorReturn),getPrototypeOf=createCommonjsModule(function(e){function t(o){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(o)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}),_getPrototypeOf=unwrapExports(getPrototypeOf),setPrototypeOf=createCommonjsModule(function(e){function t(o,r){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(o,r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports});unwrapExports(setPrototypeOf);var inherits=createCommonjsModule(function(e){e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&setPrototypeOf(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports}),_inherits=unwrapExports(inherits);function _callSuper(e,t,o){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,o||[],_getPrototypeOf(e).constructor):t.apply(e,o))}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}var defaultProps={url:"",name:"",title:"",features:{width:"600px",height:"640px"},onBlock:null,onOpen:null,onUnload:null,center:"parent",copyStyles:!0},NewWindow=function(e){function t(e){var o;_classCallCheck(this,t);var r=Object.assign({},defaultProps,e);return(o=_callSuper(this,t,[r])).props=r,o.container=document.createElement("div"),o.window=null,o.windowCheckerInterval=null,o.released=!1,o.state={mounted:!1},o}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return this.state.mounted?ReactDOM.createPortal(this.props.children,this.container):null}},{key:"componentDidMount",value:function(){this.released=!1,this.openChild(),this.setState({mounted:!0})}},{key:"openChild",value:function(){var e=this,t=this.props,o=t.url,r=t.title,n=t.name,i=t.features,s=t.onBlock,u=t.onOpen,c=t.center;if("string"!=typeof c||void 0!==i.width&&void 0!==i.height){if("parent"===c)i.left=window.top.outerWidth/2+window.top.screenX-i.width/2,i.top=window.top.outerHeight/2+window.top.screenY-i.height/2;else if("screen"===c){var l=void 0!==window.screenLeft?window.screenLeft:window.screen.left,a=void 0!==window.screenTop?window.screenTop:window.screen.top,p=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width,d=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height;i.left=p/2-i.width/2+l,i.top=d/2-i.height/2+a}}else console.warn("width and height window features must be present when a center prop is provided");this.window=window.open(o,n,toWindowFeatures(i)),this.windowCheckerInterval=setInterval(function(){e.window&&!e.window.closed||e.release()},50),this.window?(this.window.document.title=r,this.window.document.body.appendChild(this.container),this.props.copyStyles&&setTimeout(function(){return copyStyles(document,e.window.document)},0),"function"==typeof u&&u(this.window),this.window.addEventListener("beforeunload",function(){return e.release()})):"function"==typeof s?s(null):console.warn("A new window could not be opened. Maybe it was blocked.")}},{key:"componentWillUnmount",value:function(){this.window&&(this.window.close(),this.window=null),this.release(),this.windowCheckerInterval&&(this.windowCheckerInterval=null)}},{key:"release",value:function(){if(!this.released){this.released=!0,clearInterval(this.windowCheckerInterval);var e=this.props.onUnload;"function"==typeof e&&e(null)}}}])}(React.PureComponent);function copyStyles(e,t){Array.from(e.styleSheets).forEach(function(o){var r;try{r=o.cssRules}catch(e){console.error(e)}var n=r&&Object.values(r).some(function(e){return e instanceof CSSFontFaceRule})&&o.href;if(r&&!n){var i=e.createElement("style");Array.from(o.cssRules).forEach(function(t){var o=t.cssText,r=t.type,n=o;[3,5].includes(r)&&(n=o.split("url(").map(function(e){return"/"===e[1]?"".concat(e.slice(0,1)).concat(window.location.origin).concat(e.slice(1)):e}).join("url(")),i.appendChild(e.createTextNode(n))}),t.head.appendChild(i)}else if(o.href){var s=e.createElement("link");s.rel="stylesheet",s.href=o.href,t.head.appendChild(s)}})}function toWindowFeatures(e){return Object.keys(e).reduce(function(t,o){var r=e[o];return"boolean"==typeof r?t.push("".concat(o,"=").concat(r?"yes":"no")):t.push("".concat(o,"=").concat(r)),t},[]).join(",")}module.exports=NewWindow;
//# sourceMappingURL=react-new-window.js.map
