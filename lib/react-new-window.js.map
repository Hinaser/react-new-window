{"version":3,"file":"react-new-window.js","sources":["../node_modules/@babel/runtime/helpers/classCallCheck.js","../node_modules/@babel/runtime/helpers/typeof.js","../node_modules/@babel/runtime/helpers/toPrimitive.js","../node_modules/@babel/runtime/helpers/toPropertyKey.js","../node_modules/@babel/runtime/helpers/createClass.js","../node_modules/@babel/runtime/helpers/assertThisInitialized.js","../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","../node_modules/@babel/runtime/helpers/getPrototypeOf.js","../node_modules/@babel/runtime/helpers/setPrototypeOf.js","../node_modules/@babel/runtime/helpers/inherits.js","../src/NewWindow.js"],"sourcesContent":["function _classCallCheck(a, n) {\n  if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\");\n}\nmodule.exports = _classCallCheck, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _typeof(o);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nmodule.exports = toPrimitive, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nvar toPrimitive = require(\"./toPrimitive.js\");\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nmodule.exports = toPropertyKey, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var toPropertyKey = require(\"./toPropertyKey.js\");\nfunction _defineProperties(e, r) {\n  for (var t = 0; t < r.length; t++) {\n    var o = r[t];\n    o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, toPropertyKey(o.key), o);\n  }\n}\nfunction _createClass(e, r, t) {\n  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), e;\n}\nmodule.exports = _createClass, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _assertThisInitialized(e) {\n  if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  return e;\n}\nmodule.exports = _assertThisInitialized, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nvar assertThisInitialized = require(\"./assertThisInitialized.js\");\nfunction _possibleConstructorReturn(t, e) {\n  if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e;\n  if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\");\n  return assertThisInitialized(t);\n}\nmodule.exports = _possibleConstructorReturn, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _getPrototypeOf(t) {\n  return module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) {\n    return t.__proto__ || Object.getPrototypeOf(t);\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _getPrototypeOf(t);\n}\nmodule.exports = _getPrototypeOf, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _setPrototypeOf(t, e) {\n  return module.exports = _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _setPrototypeOf(t, e);\n}\nmodule.exports = _setPrototypeOf, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var setPrototypeOf = require(\"./setPrototypeOf.js\");\nfunction _inherits(t, e) {\n  if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\");\n  t.prototype = Object.create(e && e.prototype, {\n    constructor: {\n      value: t,\n      writable: !0,\n      configurable: !0\n    }\n  }), Object.defineProperty(t, \"prototype\", {\n    writable: !1\n  }), e && setPrototypeOf(t, e);\n}\nmodule.exports = _inherits, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","/**\r\n * Component dependencies.\r\n * @private\r\n */\r\n\r\nimport React from 'react'\r\nimport ReactDOM from 'react-dom'\r\n\r\n/**\r\n * NewWindow default props.\r\n */\r\nconst defaultProps = {\r\n  url: '',\r\n  name: '',\r\n  title: '',\r\n  features: { width: '600px', height: '640px' },\r\n  onBlock: null,\r\n  onOpen: null,\r\n  onUnload: null,\r\n  center: 'parent',\r\n  copyStyles: true\r\n}\r\n\r\n/**\r\n * The NewWindow class object.\r\n * @public\r\n */\r\n\r\nclass NewWindow extends React.PureComponent {\r\n  /**\r\n   * The NewWindow function constructor.\r\n   * @param {Object} props\r\n   */\r\n  constructor(props) {\r\n    super(props)\r\n    this.props = Object.assign({}, defaultProps, props)\r\n\r\n    this.container = document.createElement('div')\r\n    this.window = null\r\n    this.windowCheckerInterval = null\r\n    this.unmountDelay = null\r\n    this.released = false\r\n    this.state = {\r\n      mounted: 0\r\n    }\r\n    console.error('constructor called')\r\n  }\r\n\r\n  /**\r\n   * Render the NewWindow component.\r\n   */\r\n  render() {\r\n    console.error(\r\n      'render called',\r\n      this.state,\r\n      this.window,\r\n      this.windowCheckerInterval\r\n    )\r\n\r\n    if (!this.state.mounted) return null\r\n    return ReactDOM.createPortal(this.props.children, this.container)\r\n  }\r\n\r\n  componentDidMount() {\r\n    console.error(\r\n      'componentDidMount called',\r\n      this.state,\r\n      this.window,\r\n      this.windowCheckerInterval\r\n    )\r\n    if (this.unmountDelay) {\r\n      clearTimeout(this.unmountDelay)\r\n      this.unmountDelay = null\r\n    }\r\n\r\n    this.released = false\r\n    this.openChild()\r\n    this.setState(prev => ({ mounted: prev.mounted + 1 }))\r\n  }\r\n\r\n  /**\r\n   * Close the opened window (if any) when NewWindow will unmount.\r\n   */\r\n  componentWillUnmount() {\r\n    console.error(\r\n      'componentWillUnmount called',\r\n      this.window,\r\n      this.windowCheckerInterval\r\n    )\r\n    this.unmountDelay = setTimeout(() => {\r\n      if (this.window) {\r\n        this.window.close()\r\n        this.window = null\r\n      }\r\n\r\n      this.release()\r\n    }, 13)\r\n  }\r\n\r\n  /**\r\n   * Create the new window when NewWindow component mount.\r\n   */\r\n  openChild() {\r\n    const { url, title, name, features, onBlock, onOpen, center } = this.props\r\n\r\n    // Prepare position of the new window to be centered against the 'parent' window or 'screen'.\r\n    if (\r\n      typeof center === 'string' &&\r\n      (features.width === undefined || features.height === undefined)\r\n    ) {\r\n      console.warn(\r\n        'width and height window features must be present when a center prop is provided'\r\n      )\r\n    } else if (center === 'parent') {\r\n      features.left =\r\n        window.top.outerWidth / 2 + window.top.screenX - features.width / 2\r\n      features.top =\r\n        window.top.outerHeight / 2 + window.top.screenY - features.height / 2\r\n    } else if (center === 'screen') {\r\n      const screenLeft =\r\n        window.screenLeft !== undefined ? window.screenLeft : window.screen.left\r\n      const screenTop =\r\n        window.screenTop !== undefined ? window.screenTop : window.screen.top\r\n\r\n      const width = window.innerWidth\r\n        ? window.innerWidth\r\n        : document.documentElement.clientWidth\r\n        ? document.documentElement.clientWidth\r\n        : window.screen.width\r\n      const height = window.innerHeight\r\n        ? window.innerHeight\r\n        : document.documentElement.clientHeight\r\n        ? document.documentElement.clientHeight\r\n        : window.screen.height\r\n\r\n      features.left = width / 2 - features.width / 2 + screenLeft\r\n      features.top = height / 2 - features.height / 2 + screenTop\r\n    }\r\n\r\n    // Open a new window.\r\n    this.window = window.open(url, name, toWindowFeatures(features))\r\n\r\n    // When a new window use content from a cross-origin there's no way we can attach event\r\n    // to it. Therefore, we need to detect in a interval when the new window was destroyed\r\n    // or was closed.\r\n    this.windowCheckerInterval = setInterval(() => {\r\n      if (!this.window || this.window.closed) {\r\n        console.error('setInterval called')\r\n        this.release()\r\n      }\r\n    }, 50)\r\n\r\n    // Check if the new window was succesfully opened.\r\n    if (this.window) {\r\n      this.window.document.title = title\r\n      this.window.document.body.appendChild(this.container)\r\n\r\n      // If specified, copy styles from parent window's document.\r\n      if (this.props.copyStyles) {\r\n        setTimeout(() => copyStyles(document, this.window.document), 0)\r\n      }\r\n\r\n      if (typeof onOpen === 'function') {\r\n        onOpen(this.window)\r\n      }\r\n\r\n      // Release anything bound to this component before the new window unload.\r\n      this.window.addEventListener('beforeunload', () => {\r\n        console.error('beforeunload called')\r\n        this.release()\r\n      })\r\n    } else {\r\n      // Handle error on opening of new window.\r\n      if (typeof onBlock === 'function') {\r\n        onBlock(null)\r\n      } else {\r\n        console.warn('A new window could not be opened. Maybe it was blocked.')\r\n      }\r\n    }\r\n  }\r\n\r\n  release() {\r\n    if (this.released) {\r\n      return\r\n    }\r\n    this.released = true\r\n\r\n    if (this.windowCheckerInterval) {\r\n      clearTimeout(this.windowCheckerInterval)\r\n    }\r\n\r\n    // Call any function bound to the `onUnload` prop.\r\n    const { onUnload } = this.props\r\n    if (typeof onUnload === 'function') {\r\n      onUnload(null)\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Utility functions.\r\n * @private\r\n */\r\n\r\n/**\r\n * Copy styles from a source document to a target.\r\n * @param {Object} source\r\n * @param {Object} target\r\n * @private\r\n */\r\n\r\nfunction copyStyles(source, target) {\r\n  Array.from(source.styleSheets).forEach(styleSheet => {\r\n    // For <style> elements\r\n    let rules\r\n    try {\r\n      rules = styleSheet.cssRules\r\n    } catch (err) {\r\n      console.error(err)\r\n    }\r\n\r\n    // For @font-face rule, it must be loaded via <link href=''> because the\r\n    // rule contains relative path from the css file.\r\n    const isFontFaceRule =\r\n      rules &&\r\n      Object.values(rules).some(r => r instanceof CSSFontFaceRule) &&\r\n      styleSheet.href\r\n\r\n    if (rules && !isFontFaceRule) {\r\n      const newStyleEl = source.createElement('style')\r\n\r\n      // Write the text of each rule into the body of the style element\r\n      Array.from(styleSheet.cssRules).forEach(cssRule => {\r\n        const { cssText, type } = cssRule\r\n        let returnText = cssText\r\n        // Check if the cssRule type is CSSImportRule (3) or CSSFontFaceRule (5) to handle local imports on a about:blank page\r\n        // '/custom.css' turns to 'http://my-site.com/custom.css'\r\n        if ([3, 5].includes(type)) {\r\n          returnText = cssText\r\n            .split('url(')\r\n            .map(line => {\r\n              if (line[1] === '/') {\r\n                return `${line.slice(0, 1)}${\r\n                  window.location.origin\r\n                }${line.slice(1)}`\r\n              }\r\n              return line\r\n            })\r\n            .join('url(')\r\n        }\r\n        newStyleEl.appendChild(source.createTextNode(returnText))\r\n      })\r\n\r\n      target.head.appendChild(newStyleEl)\r\n    } else if (styleSheet.href) {\r\n      // for <link> elements loading CSS from a URL\r\n      const newLinkEl = source.createElement('link')\r\n\r\n      newLinkEl.rel = 'stylesheet'\r\n      newLinkEl.href = styleSheet.href\r\n      target.head.appendChild(newLinkEl)\r\n    }\r\n  })\r\n}\r\n\r\n/**\r\n * Convert features props to window features format (name=value,other=value).\r\n * @param {Object} obj\r\n * @return {String}\r\n * @private\r\n */\r\n\r\nfunction toWindowFeatures(obj) {\r\n  return Object.keys(obj)\r\n    .reduce((features, name) => {\r\n      const value = obj[name]\r\n      if (typeof value === 'boolean') {\r\n        features.push(`${name}=${value ? 'yes' : 'no'}`)\r\n      } else {\r\n        features.push(`${name}=${value}`)\r\n      }\r\n      return features\r\n    }, [])\r\n    .join(',')\r\n}\r\n\r\n/**\r\n * Component export.\r\n * @private\r\n */\r\n\r\nexport default NewWindow\r\n"],"names":["module","a","n","TypeError","exports","_typeof","o","Symbol","iterator","constructor","prototype","require$$0","t","r","e","toPrimitive","i","call","String","Number","_defineProperties","length","enumerable","configurable","writable","Object","defineProperty","toPropertyKey","key","ReferenceError","assertThisInitialized","_getPrototypeOf","setPrototypeOf","getPrototypeOf","bind","__proto__","_setPrototypeOf","create","value","defaultProps","url","name","title","features","width","height","onBlock","onOpen","onUnload","center","copyStyles","NewWindow","_React$PureComponent","props","_this","_classCallCheck","_callSuper","assign","container","document","createElement","window","windowCheckerInterval","unmountDelay","released","state","mounted","console","error","_inherits","_createClass","this","ReactDOM","createPortal","children","clearTimeout","openChild","setState","prev","_this2","setTimeout","close","release","_this3","_this$props","undefined","left","top","outerWidth","screenX","outerHeight","screenY","screenLeft","screen","screenTop","innerWidth","documentElement","clientWidth","innerHeight","clientHeight","warn","open","toWindowFeatures","setInterval","closed","body","appendChild","addEventListener","React","PureComponent","source","target","Array","from","styleSheets","forEach","styleSheet","rules","cssRules","err","isFontFaceRule","values","some","CSSFontFaceRule","href","newStyleEl","cssRule","cssText","type","returnText","includes","split","map","line","concat","slice","location","origin","join","createTextNode","head","newLinkEl","rel","obj","keys","reduce","push"],"mappings":"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"}