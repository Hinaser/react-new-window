{"version":3,"file":"react-new-window.js","sources":["../node_modules/@babel/runtime/helpers/classCallCheck.js","../node_modules/@babel/runtime/helpers/typeof.js","../node_modules/@babel/runtime/helpers/toPrimitive.js","../node_modules/@babel/runtime/helpers/toPropertyKey.js","../node_modules/@babel/runtime/helpers/createClass.js","../node_modules/@babel/runtime/helpers/assertThisInitialized.js","../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","../node_modules/@babel/runtime/helpers/getPrototypeOf.js","../node_modules/@babel/runtime/helpers/setPrototypeOf.js","../node_modules/@babel/runtime/helpers/inherits.js","../node_modules/@babel/runtime/helpers/defineProperty.js","../src/NewWindow.js"],"sourcesContent":["function _classCallCheck(a, n) {\n  if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\");\n}\nmodule.exports = _classCallCheck, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _typeof(o);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nmodule.exports = toPrimitive, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nvar toPrimitive = require(\"./toPrimitive.js\");\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nmodule.exports = toPropertyKey, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var toPropertyKey = require(\"./toPropertyKey.js\");\nfunction _defineProperties(e, r) {\n  for (var t = 0; t < r.length; t++) {\n    var o = r[t];\n    o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, toPropertyKey(o.key), o);\n  }\n}\nfunction _createClass(e, r, t) {\n  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), e;\n}\nmodule.exports = _createClass, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _assertThisInitialized(e) {\n  if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  return e;\n}\nmodule.exports = _assertThisInitialized, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nvar assertThisInitialized = require(\"./assertThisInitialized.js\");\nfunction _possibleConstructorReturn(t, e) {\n  if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e;\n  if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\");\n  return assertThisInitialized(t);\n}\nmodule.exports = _possibleConstructorReturn, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _getPrototypeOf(t) {\n  return module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) {\n    return t.__proto__ || Object.getPrototypeOf(t);\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _getPrototypeOf(t);\n}\nmodule.exports = _getPrototypeOf, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _setPrototypeOf(t, e) {\n  return module.exports = _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _setPrototypeOf(t, e);\n}\nmodule.exports = _setPrototypeOf, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var setPrototypeOf = require(\"./setPrototypeOf.js\");\nfunction _inherits(t, e) {\n  if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\");\n  t.prototype = Object.create(e && e.prototype, {\n    constructor: {\n      value: t,\n      writable: !0,\n      configurable: !0\n    }\n  }), Object.defineProperty(t, \"prototype\", {\n    writable: !1\n  }), e && setPrototypeOf(t, e);\n}\nmodule.exports = _inherits, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var toPropertyKey = require(\"./toPropertyKey.js\");\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nmodule.exports = _defineProperty, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","/**\r\n * Component dependencies.\r\n * @private\r\n */\r\n\r\nimport React from 'react'\r\nimport ReactDOM from 'react-dom'\r\n\r\n/**\r\n * The NewWindow class object.\r\n * @public\r\n */\r\n\r\nclass NewWindow extends React.PureComponent {\r\n  /**\r\n   * NewWindow default props.\r\n   */\r\n  static defaultProps = {\r\n    url: '',\r\n    name: '',\r\n    title: '',\r\n    features: { width: '600px', height: '640px' },\r\n    onBlock: null,\r\n    onOpen: null,\r\n    onUnload: null,\r\n    center: 'parent',\r\n    copyStyles: true\r\n  }\r\n\r\n  /**\r\n   * The NewWindow function constructor.\r\n   * @param {Object} props\r\n   */\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.container = document.createElement('div')\r\n    this.window = null\r\n    this.unmountDelayTimeout = null\r\n    this.released = false\r\n    this.state = {\r\n      mounted: 0\r\n    }\r\n    console.error('constructor called')\r\n  }\r\n\r\n  /**\r\n   * Render the NewWindow component.\r\n   */\r\n  render() {\r\n    console.error(\r\n      'render called',\r\n      this.state,\r\n      this.window,\r\n    )\r\n\r\n    if (!this.state.mounted) return null\r\n    return ReactDOM.createPortal(this.props.children, this.container)\r\n  }\r\n\r\n  componentDidMount() {\r\n    console.error(\r\n      'componentDidMount called',\r\n      this.state,\r\n      this.window,\r\n    )\r\n    if (this.unmountDelayTimeout) {\r\n      clearTimeout(this.unmountDelayTimeout)\r\n      this.unmountDelayTimeout = null\r\n    }\r\n\r\n    this.released = false\r\n    this.openChild()\r\n    this.setState(prev => ({ mounted: prev.mounted + 1 }))\r\n  }\r\n\r\n  /**\r\n   * Close the opened window (if any) when NewWindow will unmount.\r\n   */\r\n  componentWillUnmount() {\r\n    console.error(\r\n      'componentWillUnmount called',\r\n      this.window,\r\n    )\r\n    this.unmountDelayTimeout = setTimeout(() => {\r\n      if (this.window) {\r\n        this.window.close()\r\n        this.window = null\r\n      }\r\n\r\n      this.release()\r\n    }, 13)\r\n  }\r\n\r\n  /**\r\n   * Create the new window when NewWindow component mount.\r\n   */\r\n  openChild() {\r\n    const { url, title, name, features, onBlock, onOpen, center } = this.props\r\n\r\n    // Prepare position of the new window to be centered against the 'parent' window or 'screen'.\r\n    if (\r\n      typeof center === 'string' &&\r\n      (features.width === undefined || features.height === undefined)\r\n    ) {\r\n      console.warn(\r\n        'width and height window features must be present when a center prop is provided'\r\n      )\r\n    } else if (center === 'parent') {\r\n      features.left =\r\n        window.top.outerWidth / 2 + window.top.screenX - features.width / 2\r\n      features.top =\r\n        window.top.outerHeight / 2 + window.top.screenY - features.height / 2\r\n    } else if (center === 'screen') {\r\n      const screenLeft =\r\n        window.screenLeft !== undefined ? window.screenLeft : window.screen.left\r\n      const screenTop =\r\n        window.screenTop !== undefined ? window.screenTop : window.screen.top\r\n\r\n      const width = window.innerWidth\r\n        ? window.innerWidth\r\n        : document.documentElement.clientWidth\r\n        ? document.documentElement.clientWidth\r\n        : window.screen.width\r\n      const height = window.innerHeight\r\n        ? window.innerHeight\r\n        : document.documentElement.clientHeight\r\n        ? document.documentElement.clientHeight\r\n        : window.screen.height\r\n\r\n      features.left = width / 2 - features.width / 2 + screenLeft\r\n      features.top = height / 2 - features.height / 2 + screenTop\r\n    }\r\n\r\n    // Open a new window.\r\n    this.window = window.open(url, name, toWindowFeatures(features))\r\n\r\n    // When a new window use content from a cross-origin there's no way we can attach event\r\n    // to it. Therefore, we need to detect in a interval when the new window was destroyed\r\n    // or was closed.\r\n    const windowCheckerInterval = window.setInterval(() => {\r\n      if (!this.window || this.window.closed) {\r\n        console.error('setInterval called', windowCheckerInterval)\r\n        if (windowCheckerInterval) {\r\n          window.clearInterval(windowCheckerInterval)\r\n          console.error('clearInterval called', windowCheckerInterval)\r\n        }\r\n\r\n        this.release()\r\n      }\r\n    }, 50)\r\n\r\n    // Check if the new window was succesfully opened.\r\n    if (this.window) {\r\n      this.window.document.title = title\r\n      this.window.document.body.appendChild(this.container)\r\n\r\n      // If specified, copy styles from parent window's document.\r\n      if (this.props.copyStyles) {\r\n        setTimeout(() => copyStyles(document, this.window.document), 0)\r\n      }\r\n\r\n      if (typeof onOpen === 'function') {\r\n        onOpen(this.window)\r\n      }\r\n\r\n      // Release anything bound to this component before the new window unload.\r\n      this.window.addEventListener('beforeunload', () => {\r\n        console.error('beforeunload called')\r\n        this.release()\r\n      })\r\n    } else {\r\n      // Handle error on opening of new window.\r\n      if (typeof onBlock === 'function') {\r\n        onBlock(null)\r\n      } else {\r\n        console.warn('A new window could not be opened. Maybe it was blocked.')\r\n      }\r\n    }\r\n  }\r\n\r\n  release() {\r\n    if (this.released) {\r\n      return\r\n    }\r\n    this.released = true\r\n\r\n    // Call any function bound to the `onUnload` prop.\r\n    const { onUnload } = this.props\r\n    if (typeof onUnload === 'function') {\r\n      onUnload(null)\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Utility functions.\r\n * @private\r\n */\r\n\r\n/**\r\n * Copy styles from a source document to a target.\r\n * @param {Object} source\r\n * @param {Object} target\r\n * @private\r\n */\r\n\r\nfunction copyStyles(source, target) {\r\n  Array.from(source.styleSheets).forEach(styleSheet => {\r\n    // For <style> elements\r\n    let rules\r\n    try {\r\n      rules = styleSheet.cssRules\r\n    } catch (err) {\r\n      console.error(err)\r\n    }\r\n\r\n    // For @font-face rule, it must be loaded via <link href=''> because the\r\n    // rule contains relative path from the css file.\r\n    const isFontFaceRule =\r\n      rules &&\r\n      Object.values(rules).some(r => r instanceof CSSFontFaceRule) &&\r\n      styleSheet.href\r\n\r\n    if (rules && !isFontFaceRule) {\r\n      const newStyleEl = source.createElement('style')\r\n\r\n      // Write the text of each rule into the body of the style element\r\n      Array.from(styleSheet.cssRules).forEach(cssRule => {\r\n        const { cssText, type } = cssRule\r\n        let returnText = cssText\r\n        // Check if the cssRule type is CSSImportRule (3) or CSSFontFaceRule (5) to handle local imports on a about:blank page\r\n        // '/custom.css' turns to 'http://my-site.com/custom.css'\r\n        if ([3, 5].includes(type)) {\r\n          returnText = cssText\r\n            .split('url(')\r\n            .map(line => {\r\n              if (line[1] === '/') {\r\n                return `${line.slice(0, 1)}${\r\n                  window.location.origin\r\n                }${line.slice(1)}`\r\n              }\r\n              return line\r\n            })\r\n            .join('url(')\r\n        }\r\n        newStyleEl.appendChild(source.createTextNode(returnText))\r\n      })\r\n\r\n      target.head.appendChild(newStyleEl)\r\n    } else if (styleSheet.href) {\r\n      // for <link> elements loading CSS from a URL\r\n      const newLinkEl = source.createElement('link')\r\n\r\n      newLinkEl.rel = 'stylesheet'\r\n      newLinkEl.href = styleSheet.href\r\n      target.head.appendChild(newLinkEl)\r\n    }\r\n  })\r\n}\r\n\r\n/**\r\n * Convert features props to window features format (name=value,other=value).\r\n * @param {Object} obj\r\n * @return {String}\r\n * @private\r\n */\r\n\r\nfunction toWindowFeatures(obj) {\r\n  return Object.keys(obj)\r\n    .reduce((features, name) => {\r\n      const value = obj[name]\r\n      if (typeof value === 'boolean') {\r\n        features.push(`${name}=${value ? 'yes' : 'no'}`)\r\n      } else {\r\n        features.push(`${name}=${value}`)\r\n      }\r\n      return features\r\n    }, [])\r\n    .join(',')\r\n}\r\n\r\n/**\r\n * Component export.\r\n * @private\r\n */\r\n\r\nexport default NewWindow\r\n"],"names":["module","a","n","TypeError","exports","_typeof","o","Symbol","iterator","constructor","prototype","require$$0","t","r","e","toPrimitive","i","call","String","Number","_defineProperties","length","enumerable","configurable","writable","Object","defineProperty","toPropertyKey","key","ReferenceError","assertThisInitialized","_getPrototypeOf","setPrototypeOf","getPrototypeOf","bind","__proto__","_setPrototypeOf","create","value","NewWindow","_React$PureComponent","props","_this","_classCallCheck","_callSuper","container","document","createElement","window","unmountDelayTimeout","released","state","mounted","console","error","_inherits","_createClass","this","ReactDOM","createPortal","children","clearTimeout","openChild","setState","prev","_this2","setTimeout","close","release","obj","_this3","_this$props","url","title","name","features","onBlock","onOpen","center","undefined","width","height","left","top","outerWidth","screenX","outerHeight","screenY","screenLeft","screen","screenTop","innerWidth","documentElement","clientWidth","innerHeight","clientHeight","warn","open","keys","reduce","push","concat","join","windowCheckerInterval","setInterval","closed","clearInterval","body","appendChild","copyStyles","source","target","Array","from","styleSheets","forEach","styleSheet","rules","cssRules","err","isFontFaceRule","values","some","CSSFontFaceRule","href","newStyleEl","cssRule","cssText","type","returnText","includes","split","map","line","slice","location","origin","createTextNode","head","newLinkEl","rel","addEventListener","onUnload","React","PureComponent","_defineProperty"],"mappings":"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"}